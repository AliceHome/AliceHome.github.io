<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.2" />






<meta name="description" content="The Loneliest Whale in the World">
<meta property="og:type" content="website">
<meta property="og:title" content="Hi, this is Alice Home">
<meta property="og:url" content="http://yoursite.com/page/7/index.html">
<meta property="og:site_name" content="Hi, this is Alice Home">
<meta property="og:description" content="The Loneliest Whale in the World">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hi, this is Alice Home">
<meta name="twitter:description" content="The Loneliest Whale in the World">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/7/"/>





  <title>Hi, this is Alice Home</title>
  














</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

<a href="https://github.com/AliceHome" class="github-corner" aria-label="View source on Github"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#64CEAA; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px)
{.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Hi, this is Alice Home</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-commonweal">
          <a href="/404" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br />
            
            公益404
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/12/01/Pre/Learning-SQLite-for-iOS/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Alice">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hi, this is Alice Home">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/12/01/Pre/Learning-SQLite-for-iOS/" itemprop="url">Learning SQLite for iOS</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-12-01T17:27:57+08:00">
                2016-12-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS/" itemprop="url" rel="index">
                    <span itemprop="name">iOS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>[TOC]</p>
<h1 id="Chapter-1：介绍-SQL-和-SQLite-这一章节，介绍-SQL（structured-query-Language）-北京和移动数据库-——-SQLite"><a href="#Chapter-1：介绍-SQL-和-SQLite-这一章节，介绍-SQL（structured-query-Language）-北京和移动数据库-——-SQLite" class="headerlink" title="Chapter 1：介绍 SQL 和 SQLite 这一章节，介绍 SQL（structured query Language） 北京和移动数据库 —— SQLite."></a>Chapter 1：介绍 SQL 和 SQLite 这一章节，介绍 SQL（structured query Language） 北京和移动数据库 —— SQLite.</h1><h2 id="About-SQL"><a href="#About-SQL" class="headerlink" title="About SQL"></a>About SQL</h2><h2 id="Where-does-SQLite-stand-in-today‘s-industry"><a href="#Where-does-SQLite-stand-in-today‘s-industry" class="headerlink" title="Where does SQLite stand in today‘s industry ?"></a>Where does SQLite stand in today‘s industry ?</h2><h2 id="iOS-with-SQLite"><a href="#iOS-with-SQLite" class="headerlink" title="iOS with SQLite"></a>iOS with SQLite</h2><h2 id="Embedded-database"><a href="#Embedded-database" class="headerlink" title="Embedded database"></a>Embedded database</h2><h2 id="The-architecture-of-the-SQLite-database"><a href="#The-architecture-of-the-SQLite-database" class="headerlink" title="The architecture of the SQLite database"></a>The architecture of the SQLite database</h2><h2 id="Features"><a href="#Features" class="headerlink" title="Features"></a>Features</h2><h2 id="The-advantages-of-using-SQLite"><a href="#The-advantages-of-using-SQLite" class="headerlink" title="The advantages of using SQLite"></a>The advantages of using SQLite</h2><p>SQLite 数据的优点：</p>
<ul>
<li>SQLite 有数据限制特性以及编辑或者删除表不需要加载到内存中</li>
<li>SQLite 的数据存储在硬盘上，速度比 Core Data 慢一些</li>
<li>Core Data 没有数据限制，需要通过 app 的业务逻辑来限制数据量</li>
<li><h2 id="Working-with-SQLite"><a href="#Working-with-SQLite" class="headerlink" title="Working with SQLite"></a>Working with SQLite</h2>SQLite 官网：www.sqlite.org，在这个官网上可以下载数据库二进制源码，可以查看文档和源代码。在这里，提供了 SQLite 的共享库以及 DLL，当然还有 CLP（command-line-program)，还支持 TCL 扩展，可以通过它进行数据库的链接和更新。<h2 id="The-examples-of-using-SQLite-with-iOS"><a href="#The-examples-of-using-SQLite-with-iOS" class="headerlink" title="The examples of using SQLite with iOS"></a>The examples of using SQLite with iOS</h2></li>
</ul>
<h1 id="Chapter-2：数据库设计概念"><a href="#Chapter-2：数据库设计概念" class="headerlink" title="Chapter 2：数据库设计概念"></a>Chapter 2：数据库设计概念</h1><h1 id="Chapter-3：管理数据库"><a href="#Chapter-3：管理数据库" class="headerlink" title="Chapter 3：管理数据库"></a>Chapter 3：管理数据库</h1><h1 id="Chapter-4：Essentials-of-SQL"><a href="#Chapter-4：Essentials-of-SQL" class="headerlink" title="Chapter 4：Essentials of SQL"></a>Chapter 4：Essentials of SQL</h1><h1 id="Chapter-5：Exposing-C-API"><a href="#Chapter-5：Exposing-C-API" class="headerlink" title="Chapter 5：Exposing C API"></a>Chapter 5：Exposing C API</h1><p>C API 的调用，通过这些 API我们可以很方便的在应用程序中访问数据库。大约有 200 多个 API  供调用。</p>
<h1 id="Chapter-6：Swift-with-SQLite"><a href="#Chapter-6：Swift-with-SQLite" class="headerlink" title="Chapter 6：Swift with SQLite"></a>Chapter 6：Swift with SQLite</h1><h1 id="Chapter-7："><a href="#Chapter-7：" class="headerlink" title="Chapter 7："></a>Chapter 7：</h1><h1 id="Chapter-8："><a href="#Chapter-8：" class="headerlink" title="Chapter 8："></a>Chapter 8：</h1>
          
        
      
    </div>
    
    
    

    <div>
      
    </div>
    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/03/03/Pre/Python-Tour/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Alice">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hi, this is Alice Home">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/03/03/Pre/Python-Tour/" itemprop="url">Python Tour</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-03-03T14:15:16+08:00">
                2016-03-03
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python/" itemprop="url" rel="index">
                    <span itemprop="name">Python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Mac-OS-与-Python"><a href="#Mac-OS-与-Python" class="headerlink" title="Mac OS 与 Python"></a>Mac OS 与 Python</h2><p>Mac OS 自带了 Python 环境:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ which python</span><br><span class="line">/usr/bin/python</span><br><span class="line">$ /usr/bin/python; exit</span><br><span class="line">Python 2.7.10 (default, Oct  6 2017, 22:29:07)</span><br><span class="line">[GCC 4.2.1 Compatible Apple LLVM 9.0.0 (clang-900.0.31)] on darwin</span><br><span class="line">Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<h2 id="Pip"><a href="#Pip" class="headerlink" title="Pip"></a>Pip</h2><p>Python 的使用离不开 <a href="https://pypi.org/project/pip/" target="_blank" rel="noopener">pip</a>，如果当前的 Python 2  &gt;= 2.7.9 或者 Python 3 &gt;= 3.4 那么实际上已经安装了 pip 了。<br>pip 安装的方式有三种</p>
<ul>
<li>根据官网中的 install 模块进行安装，这种安装需要一些依赖模块</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">python get-pip.py</span><br><span class="line"></span><br><span class="line">Collecting pip</span><br><span class="line">  Downloading https://files.pythonhosted.org/packages/0f/74/ecd13431bcc456ed390b44c8a6e917c1820365cbebcb6a8974d1cd045ab4/pip-10.0.1-py2.py3-none-any.whl (1.3MB)</span><br><span class="line">    100% |████████████████████████████████| 1.3MB 272kB/s</span><br><span class="line">Collecting wheel</span><br><span class="line">  Downloading https://files.pythonhosted.org/packages/81/30/e935244ca6165187ae8be876b6316ae201b71485538ffac1d718843025a9/wheel-0.31.1-py2.py3-none-any.whl (41kB)</span><br><span class="line">    100% |████████████████████████████████| 51kB 73kB/s</span><br><span class="line">matplotlib 1.3.1 requires nose, which is not installed.</span><br><span class="line">matplotlib 1.3.1 requires tornado, which is not installed.</span><br><span class="line">Installing collected packages: pip, wheel</span><br><span class="line">Could not install packages due to an EnvironmentError: [Errno 13] Permission denied: &apos;/Library/Python/2.7/site-packages/pip-10.0.1.dist-info&apos;</span><br><span class="line">Consider using the `--user` option or check the permissions.</span><br></pre></td></tr></table></figure>
<ul>
<li>brew install pip 也是可以安装的，但是这种安装需要通过 brew install python 进行，这将会导致你的电脑上有两个版本的 python</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Error: No available formula with the name &quot;pip&quot;</span><br><span class="line">Homebrew provides pip via: `brew install python`. However you will then</span><br><span class="line">have two Pythons installed on your Mac, so alternatively you can install</span><br><span class="line">pip via the instructions at:</span><br><span class="line">  https://pip.readthedocs.io/en/stable/installing/</span><br></pre></td></tr></table></figure>
<ul>
<li>sudo easy_install pip </li>
</ul>
<p>因为前两种方式都需要一些额外的东西，所以我选择了第三种安装方式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">$ sudo easy_install pip</span><br><span class="line">Password:</span><br><span class="line">Searching for pip</span><br><span class="line">Reading https://pypi.python.org/simple/pip/</span><br><span class="line">Best match: pip 10.0.1</span><br><span class="line">Downloading https://files.pythonhosted.org/packages/ae/e8/2340d46ecadb1692a1e455f13f75e596d4eab3d11a57446f08259dee8f02/pip-10.0.1.tar.gz#sha256=f2bd08e0cd1b06e10218feaf6fef299f473ba706582eb3bd9d52203fdbd7ee68</span><br><span class="line">Processing pip-10.0.1.tar.gz</span><br><span class="line">Writing /tmp/easy_install-wo7aGC/pip-10.0.1/setup.cfg</span><br><span class="line">Running pip-10.0.1/setup.py -q bdist_egg --dist-dir /tmp/easy_install-wo7aGC/pip-10.0.1/egg-dist-tmp-ny5uXk</span><br><span class="line">/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/distutils/dist.py:267: UserWarning: Unknown distribution option: &apos;python_requires&apos;</span><br><span class="line">  warnings.warn(msg)</span><br><span class="line">warning: no previously-included files found matching &apos;.coveragerc&apos;</span><br><span class="line">warning: no previously-included files found matching &apos;.mailmap&apos;</span><br><span class="line">warning: no previously-included files found matching &apos;.travis.yml&apos;</span><br><span class="line">warning: no previously-included files found matching &apos;.landscape.yml&apos;</span><br><span class="line">warning: no previously-included files found matching &apos;src/pip/_vendor/Makefile&apos;</span><br><span class="line">warning: no previously-included files found matching &apos;tox.ini&apos;</span><br><span class="line">warning: no previously-included files found matching &apos;*-requirements.txt&apos;</span><br><span class="line">warning: no previously-included files found matching &apos;appveyor.yml&apos;</span><br><span class="line">warning: no previously-included files found matching &apos;src/pip/_vendor/six&apos;</span><br><span class="line">warning: no previously-included files matching &apos;*.pyi&apos; found under directory &apos;src/pip/_vendor&apos;</span><br><span class="line">no previously-included directories found matching &apos;.github&apos;</span><br><span class="line">no previously-included directories found matching &apos;.travis&apos;</span><br><span class="line">no previously-included directories found matching &apos;docs/build&apos;</span><br><span class="line">no previously-included directories found matching &apos;news&apos;</span><br><span class="line">no previously-included directories found matching &apos;contrib&apos;</span><br><span class="line">no previously-included directories found matching &apos;tasks&apos;</span><br><span class="line">no previously-included directories found matching &apos;tests&apos;</span><br><span class="line">creating /Library/Python/2.7/site-packages/pip-10.0.1-py2.7.egg</span><br><span class="line">Extracting pip-10.0.1-py2.7.egg to /Library/Python/2.7/site-packages</span><br><span class="line">Adding pip 10.0.1 to easy-install.pth file</span><br><span class="line">Installing pip script to /usr/local/bin</span><br><span class="line">Installing pip2.7 script to /usr/local/bin</span><br><span class="line">Installing pip2 script to /usr/local/bin</span><br><span class="line"></span><br><span class="line">Installed /Library/Python/2.7/site-packages/pip-10.0.1-py2.7.egg</span><br><span class="line">Processing dependencies for pip</span><br><span class="line">Finished processing dependencies for pip</span><br><span class="line"></span><br><span class="line"># maple @ iMac in ~/Maple [14:26:43]</span><br><span class="line">$ which pip</span><br><span class="line">/usr/local/bin/pip</span><br></pre></td></tr></table></figure>
<h2 id="iPython"><a href="#iPython" class="headerlink" title="iPython"></a>iPython</h2><p><a href="http://ipython.org" target="_blank" rel="noopener">iPython</a> 这是一个很好 Python 交互环境开发工具 “brew install iPython” 就可以安装</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ ipython</span><br><span class="line">Python 3.6.5 (default, Apr 25 2018, 14:23:58)</span><br><span class="line">Type &apos;copyright&apos;, &apos;credits&apos; or &apos;license&apos; for more information</span><br><span class="line">IPython 6.4.0 -- An enhanced Interactive Python. Type &apos;?&apos; for help.</span><br><span class="line"></span><br><span class="line">In [1]:</span><br></pre></td></tr></table></figure>
<p>详细了解，可以通过 <a href="http://ipython.readthedocs.io/en/stable/index.html" target="_blank" rel="noopener">iPython Documentation</a></p>

          
        
      
    </div>
    
    
    

    <div>
      
    </div>
    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/01/03/Pre/2016/Python 绝技/Python-绝技/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Alice">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hi, this is Alice Home">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/01/03/Pre/2016/Python 绝技/Python-绝技/" itemprop="url">Python 绝技 之 入门</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-01-03T14:52:35+08:00">
                2016-01-03
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python/" itemprop="url" rel="index">
                    <span itemprop="name">Python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="准备开发-amp-安装第三方库"><a href="#准备开发-amp-安装第三方库" class="headerlink" title="准备开发 &amp; 安装第三方库"></a>准备开发 &amp; 安装第三方库</h3><p>Python 环境在 Mac 上已经自带。并提供了 Python 标准库和解释器，以及一些内置模块，这些内置模块包括：内置数据类型、异常处理、numeric 和数学模块、文件处理模块、加密服务、与操作系统相互交互操作、网络、与 IP 协议交互以及其他有用模块。<br>同样 Python 也提供第三方软件包：<a href="https://pypi.org" target="_blank" rel="noopener">https://pypi.org</a></p>
<p>三种方式：</p>
<ul>
<li>下载第三方库包，解压，然后通过 <em>python setup.py install</em> 命令进行安装</li>
<li>sudo easy_install 包名字</li>
</ul>
<p>第二种方式，是 Python 为了使得包安装更加方便，在 setuptools 中提供了 easy_install 的模块，当执行这个模块的时候，我们需要将包名作为参数传递给它，然后它会自动到 Python 官网上搜索这个包，如果找到就下载并且自动安装。</p>
<p>安装 <em>python-nmap</em> 模块</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"> sudo easy_install python-nmap</span><br><span class="line">Password:</span><br><span class="line">Searching for python-nmap</span><br><span class="line">Reading https://pypi.python.org/simple/python-nmap/</span><br><span class="line">Best match: python-nmap 0.6.1</span><br><span class="line">Downloading https://files.pythonhosted.org/packages/dc/f2/9e1a2953d4d824e183ac033e3d223055e40e695fa6db2cb3e94a864eaa84/python-nmap-0.6.1.tar.gz#sha256=80ba0eb10a52283a54a633f40b5baa9c2ff08675d6621dd089ead942852f5bd3</span><br><span class="line">Processing python-nmap-0.6.1.tar.gz</span><br><span class="line">Writing /tmp/easy_install-kCnkg1/python-nmap-0.6.1/setup.cfg</span><br><span class="line">Running python-nmap-0.6.1/setup.py -q bdist_egg --dist-dir /tmp/easy_install-kCnkg1/python-nmap-0.6.1/egg-dist-tmp-hh31Lx</span><br><span class="line">/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/distutils/dist.py:267: UserWarning: Unknown distribution option: &apos;bugtrack_url&apos;</span><br><span class="line">  warnings.warn(msg)</span><br><span class="line">zip_safe flag not set; analyzing archive contents...</span><br><span class="line">Copying python_nmap-0.6.1-py2.7.egg to /Library/Python/2.7/site-packages</span><br><span class="line">Adding python-nmap 0.6.1 to easy-install.pth file</span><br><span class="line"></span><br><span class="line">Installed /Library/Python/2.7/site-packages/python_nmap-0.6.1-py2.7.egg</span><br><span class="line">Processing dependencies for python-nmap</span><br><span class="line">Finished processing dependencies for python-nmap</span><br></pre></td></tr></table></figure>
<p>多个包一起安装也是可以的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo easy_install pyPdf pygeoip mechanize BeautifulSoup4</span><br></pre></td></tr></table></figure>
<p>还有一些第三方库可能无法通过 easy_install 来安装，可以通过 apt-get install 进行安装， 这是 Linux 下默认的安装工具，在 Mac 下可以通过 brew 来代替， 但是还是有一些库可能 brew 没有，所以需要在 Mac 下装载 apt-get 命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="Python-标准库的关键组件"><a href="#Python-标准库的关键组件" class="headerlink" title="Python 标准库的关键组件"></a>Python 标准库的关键组件</h3><ul>
<li>变量，不需要声明，类型自动匹配</li>
<li>字符串，upper(),lower(),replace(),find()<h4 id="List-列表），就是数组元素"><a href="#List-列表），就是数组元素" class="headerlink" title="List(列表），就是数组元素"></a>List(列表），就是数组元素</h4></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">In [22]: portList=[]</span><br><span class="line"></span><br><span class="line">In [23]: type(portList)</span><br><span class="line">Out[23]: list</span><br><span class="line"></span><br><span class="line">In [24]: portList.append(21)</span><br><span class="line"></span><br><span class="line">In [25]: portList.append(25)</span><br><span class="line"></span><br><span class="line">In [26]: portList.append(443)</span><br><span class="line"></span><br><span class="line">In [27]: portList.append(80)</span><br><span class="line"></span><br><span class="line">In [28]: portList</span><br><span class="line">Out[28]: [21, 25, 443, 80]</span><br><span class="line"></span><br><span class="line">In [29]: portList.sort()</span><br><span class="line"></span><br><span class="line">In [30]: portList</span><br><span class="line">Out[30]: [21, 25, 80, 443]</span><br><span class="line"></span><br><span class="line">In [31]: portList.index(80)</span><br><span class="line">Out[31]: 2</span><br><span class="line"></span><br><span class="line">In [32]: len(portList)</span><br><span class="line">Out[32]: 4</span><br></pre></td></tr></table></figure>
<h4 id="字典"><a href="#字典" class="headerlink" title="字典"></a>字典</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">In [15]: service=&#123;&apos;ftp&apos;:21,&apos;ssh&apos;:22,&apos;stmp&apos;:25,&apos;http&apos;:80&#125;</span><br><span class="line">In [17]: service.keys()</span><br><span class="line">Out[17]: dict_keys([&apos;ftp&apos;, &apos;ssh&apos;, &apos;stmp&apos;, &apos;http&apos;])</span><br><span class="line">In [19]: service.items()</span><br><span class="line">Out[19]: dict_items([(&apos;ftp&apos;, 21), (&apos;ssh&apos;, 22), (&apos;stmp&apos;, 25), (&apos;http&apos;, 80)])</span><br><span class="line">In [20]: service[&apos;ftp&apos;]</span><br><span class="line">Out[20]: 21</span><br><span class="line"></span><br><span class="line">In [21]: service[&apos;https&apos;]</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">KeyError                                  Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input-21-07c66fb7e9f9&gt; in &lt;module&gt;()</span><br><span class="line">----&gt; 1 service[&apos;https&apos;]</span><br><span class="line"></span><br><span class="line">KeyError: &apos;https&apos;</span><br></pre></td></tr></table></figure>
<h4 id="网络"><a href="#网络" class="headerlink" title="网络"></a>网络</h4><p>socket 模块提供了一个用 Python 进行网络连接的库。</p>
<p>Client:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python</span><br><span class="line"># coding=utf-8</span><br><span class="line">import socket </span><br><span class="line"></span><br><span class="line">ip_port = (&apos;127.0.0.1&apos;,8989)</span><br><span class="line">sk = socket.socket()</span><br><span class="line">sk.connect(ip_port)</span><br><span class="line"></span><br><span class="line">ans = sk.recv(1024)</span><br><span class="line"></span><br><span class="line">print(ans)</span><br></pre></td></tr></table></figure>
<p>server：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python</span><br><span class="line"># coding=utf-8</span><br><span class="line"></span><br><span class="line">import socket</span><br><span class="line"></span><br><span class="line">ip_port = (&apos;127.0.0.1&apos;,8989)</span><br><span class="line">sk = socket.socket()</span><br><span class="line">sk.bind(ip_port)</span><br><span class="line">sk.listen(5)</span><br><span class="line"></span><br><span class="line">while True:</span><br><span class="line">    conn,address =  sk.accept()</span><br><span class="line">    conn.sendall(&apos;220 FreeFloat Ftp Server (Version 1.00).&apos;)</span><br><span class="line">    conn.close()</span><br></pre></td></tr></table></figure>
<h4 id="条件选择"><a href="#条件选择" class="headerlink" title="条件选择"></a>条件选择</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python</span><br><span class="line"># coding=utf-8</span><br><span class="line">import socket </span><br><span class="line"></span><br><span class="line">ip_port = (&apos;127.0.0.1&apos;,8989)</span><br><span class="line">sk = socket.socket()</span><br><span class="line">sk.connect(ip_port)</span><br><span class="line"></span><br><span class="line">ans = sk.recv(1024)</span><br><span class="line"></span><br><span class="line">if (&quot;FreeFloat Ftp Server (Version 1.00).&quot; in ans):</span><br><span class="line">    print(&quot;FreeFloat FTP Server is vulnerable.&quot;)</span><br><span class="line">elif (&quot;3COm 3CDaemon FTP Server Version 2.0&quot; in ans):</span><br><span class="line">    print (&quot;3CDaemon FTP Server is vulnerable.&quot;)</span><br><span class="line">elif (&quot;Sami 3CDaemon FTP Server Version 2.0&quot; in ans):</span><br><span class="line">    print (&quot;Sami FTP Server is vulnerable.&quot;)</span><br><span class="line">else:</span><br><span class="line">    print(&quot;no ftp server is vulnerable.&quot;)</span><br></pre></td></tr></table></figure>
<p>执行：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ python client.py</span><br><span class="line">FreeFloat FTP Server is vulnerable.</span><br></pre></td></tr></table></figure>
<h4 id="异常处理"><a href="#异常处理" class="headerlink" title="异常处理"></a>异常处理</h4><p>这里，还是通过上面的连接，将 ip 做一下修改，改为 127.0.1.1，然后设置超时时间为 3 秒，通过 try - except 进行异常处理</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> socket </span><br><span class="line">ip_port = (<span class="string">'127.0.1.1'</span>,<span class="number">8989</span>)</span><br><span class="line">socket.setdefaulttimeout(<span class="number">3</span>)</span><br><span class="line">sk = socket.socket()</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    sk.connect(ip_port)</span><br><span class="line"><span class="keyword">except</span> Exception, e:</span><br><span class="line">    print(<span class="string">"Error = "</span> + str(e))</span><br></pre></td></tr></table></figure>
<p>运行：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ python client.py</span><br><span class="line">Error = timed out</span><br></pre></td></tr></table></figure>
<h4 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h4><p>创建一个函数完成连接到 FTP服务器并返回 banner 的操作：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> socket </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">returnBanner</span><span class="params">(ip,port)</span>:</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        socket.setdefaulttimeout(<span class="number">3</span>)</span><br><span class="line">        sk = socket.socket()</span><br><span class="line">        sk.connect((ip,port))</span><br><span class="line">        banner = sk.recv(<span class="number">1024</span>)</span><br><span class="line">        <span class="keyword">return</span> banner.decode(<span class="string">'utf-8'</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        print(<span class="string">"Error = "</span> + str(e))</span><br><span class="line">        <span class="keyword">return</span> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    ip = <span class="string">'127.0.0.1'</span></span><br><span class="line">    port = <span class="number">8989</span></span><br><span class="line">    </span><br><span class="line">    print(ip + <span class="string">" "</span> + str(port) + <span class="string">": \n"</span> + returnBanner(ip,port))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<h4 id="循环"><a href="#循环" class="headerlink" title="循环"></a>循环</h4><p>使用 for 循环遍历整个子网</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">255</span>):</span><br><span class="line">    print(<span class="string">"192.169.1."</span> + str(x))</span><br></pre></td></tr></table></figure>
<p>output：</p>
<figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$python3</span> loop.py</span><br><span class="line"></span><br><span class="line">192.169.1.1</span><br><span class="line">192.169.1.2</span><br><span class="line">192.169.1.3</span><br><span class="line">192.169.1.4</span><br><span class="line">...</span><br><span class="line">192.169.1.252</span><br><span class="line">192.169.1.253</span><br><span class="line">192.169.1.254</span><br></pre></td></tr></table></figure>
<p>接下来，通过遍历 list 中所有的端口以及输出所有的 ip 和 port 组合</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="string">"所有子网:"</span>)</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">255</span>):</span><br><span class="line">    print(<span class="string">"192.169.1."</span> + str(x))</span><br><span class="line"></span><br><span class="line">postList = [<span class="number">21</span>,<span class="number">22</span>,<span class="number">25</span>,<span class="number">80</span>,<span class="number">110</span>]</span><br><span class="line">print(<span class="string">"所有端口："</span>)</span><br><span class="line"><span class="keyword">for</span> port <span class="keyword">in</span> postList:</span><br><span class="line">    print(port)</span><br><span class="line"></span><br><span class="line">print(<span class="string">"ip 和 port 所有可能组合"</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> ip <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">255</span>):</span><br><span class="line">    <span class="keyword">for</span> port <span class="keyword">in</span> postList:</span><br><span class="line">        print(<span class="string">"192.169.1."</span> + str(ip) + <span class="string">":"</span> + str(port))</span><br></pre></td></tr></table></figure>
<p>有了迭代 IP 和 port 的能力，就可以来检测子网中所有的 ip 地址，以及 telnet、ssh、smtp、http、imap 及 https 协议的端口</p>
<h4 id="文件-I-O"><a href="#文件-I-O" class="headerlink" title="文件 I/O"></a>文件 I/O</h4><p>通过 readline() 函数读取文件 banners.txt 内容，与服务端中 banner 信息进行对比：</p>
<p><strong>banner.txt</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">3Com 3CDame FTP Server Version 1.00</span><br><span class="line">Ability Server 2.34</span><br><span class="line">PSO Proxy 0.9</span><br><span class="line">Spipe 1.0</span><br><span class="line">TelServer FTP 1.20</span><br><span class="line">Xitmai</span><br><span class="line">Maple FTP 1.90</span><br><span class="line">FreeFloat2 Ftp Server (Version 1.00)</span><br><span class="line">FreeFloat Ftp Server (Version 1.00)</span><br><span class="line">IMAP Server 1.00</span><br><span class="line">Jack 1.0</span><br><span class="line">Tom 99</span><br></pre></td></tr></table></figure>
<p><strong>service.py</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line">ip_port = (<span class="string">'127.0.0.1'</span>,<span class="number">8989</span>)</span><br><span class="line">sk = socket.socket()</span><br><span class="line">sk.bind(ip_port)</span><br><span class="line">sk.listen(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">    conn,address =  sk.accept()</span><br><span class="line">    conn.sendall(<span class="string">'220 FreeFloat Ftp Server (Version 1.00).'</span>)</span><br><span class="line">    conn.close()</span><br></pre></td></tr></table></figure>
<p><strong>client.py</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> socket </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">checkBanner</span><span class="params">(banner)</span>:</span></span><br><span class="line">    f = open(<span class="string">"banners.txt"</span>,<span class="string">'r'</span>)</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> f.readlines():</span><br><span class="line">        <span class="keyword">if</span> line.strip(<span class="string">'\n'</span>) <span class="keyword">in</span> banner:</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">False</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">returnBanner</span><span class="params">(ip,port)</span>:</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        socket.setdefaulttimeout(<span class="number">3</span>)</span><br><span class="line">        sk = socket.socket()</span><br><span class="line">        sk.connect((ip,port))</span><br><span class="line">        banner = sk.recv(<span class="number">1024</span>)</span><br><span class="line">        <span class="keyword">if</span> checkBanner(banner.decode(<span class="string">'utf-8'</span>)):</span><br><span class="line">            <span class="keyword">return</span> banner.decode(<span class="string">'utf-8'</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"nothing"</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        print(<span class="string">"Error = "</span> + str(e))</span><br><span class="line">        <span class="keyword">return</span> </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    ip = <span class="string">'127.0.0.1'</span></span><br><span class="line">    port = <span class="number">8989</span></span><br><span class="line">    print(ip + <span class="string">" "</span> + str(port) + <span class="string">": \n"</span> + returnBanner(ip,port))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<h4 id="sys"><a href="#sys" class="headerlink" title="sys"></a>sys</h4><p>通过内置 sys 模块，我们可以访问到有 Python 解释器使用或者维护的对象，其中包括标志、版本、整型数最大值、可用模块、hook 路径、标准错误/输入/输出的位置，以及调用解释器的命令行参数。<br>在线文档：<br><a href="http://docs.python.org/library/sys" target="_blank" rel="noopener">http://docs.python.org/library/sys/</a></p>
<p>从外部读取文件名字：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> len(sys.argv)==<span class="number">2</span>:</span><br><span class="line">    filename = sys.argv[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> (<span class="string">"read the content from: "</span> + filename)</span><br></pre></td></tr></table></figure>
<p>执行：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ python sys.py banners.txt</span><br><span class="line"><span class="built_in">read</span> the content from: banners.txt</span><br></pre></td></tr></table></figure>
<h4 id="OS-模块"><a href="#OS-模块" class="headerlink" title="OS 模块"></a>OS 模块</h4><p>内置 OS 模块提供了丰富的操作系统函数。这个模块允许程序独立的与操作系统环境、文件系统、用户数据库以及权限进行交互。比如上面我们在读取文件的时候提前检查一下文件是否存在：</p>
<p>文件是否存在 API：<br><em>os.path.isfile(‘fileName’)</em><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">1</span>]: <span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">In [<span class="number">2</span>]: ls</span><br><span class="line">banners.txt  client.py    loop.py      service.py   sys.py</span><br><span class="line"></span><br><span class="line">In [<span class="number">3</span>]: os.path.isfile(<span class="string">"banner.txt"</span>)</span><br><span class="line">Out[<span class="number">3</span>]: <span class="keyword">False</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">4</span>]: os.path.isfile(<span class="string">"banners.txt"</span>)</span><br><span class="line">Out[<span class="number">4</span>]: <span class="keyword">True</span></span><br></pre></td></tr></table></figure></p>
<p>权限 API：<br><em>os.access(“fileName”,权限控制)</em></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">1</span>]: <span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">In [<span class="number">2</span>]: os.access(<span class="string">"a.out"</span>, os.R_OK)</span><br><span class="line">Out[<span class="number">2</span>]: <span class="keyword">True</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">3</span>]: os.access(<span class="string">"a.out"</span>, os.W_OK)</span><br><span class="line">Out[<span class="number">3</span>]: <span class="keyword">True</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">4</span>]: ls</span><br><span class="line">a.c          banners.txt  loop.py      sys.py</span><br><span class="line">a.out*       client.py    service.py</span><br><span class="line"></span><br><span class="line">In [<span class="number">5</span>]: os.access(<span class="string">"/usr/bin/host"</span>, os.W_OK)</span><br><span class="line">Out[<span class="number">5</span>]: <span class="keyword">False</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">6</span>]: os.access(<span class="string">"/usr/bin/host"</span>, os.R_OK)</span><br><span class="line">Out[<span class="number">6</span>]: <span class="keyword">True</span></span><br></pre></td></tr></table></figure>
<hr>
<p>OVER&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</p>

          
        
      
    </div>
    
    
    

    <div>
      
    </div>
    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/01/01/Pre/NSFoundation/Foundation-NSObject/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Alice">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hi, this is Alice Home">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/01/01/Pre/NSFoundation/Foundation-NSObject/" itemprop="url">Foundation-NSObject</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-01-01T12:29:16+08:00">
                2016-01-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/NSFoundation/" itemprop="url" rel="index">
                    <span itemprop="name">NSFoundation</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>NSObject 是大部分OC类的父类，继承NSObject，可以获取访问运行时的接口，并且具备了OC对象的基本功能。<br>NSObject 实现了 <nsobject>协议，也就是拥有了一簇接口。</nsobject></p>
<h3 id="初始化类"><a href="#初始化类" class="headerlink" title="初始化类"></a>初始化类</h3><p>初始化类，提供了两个API， <em>+ initialize</em> 和 <em>+ load</em> 。</p>
<h4 id="initialize"><a href="#initialize" class="headerlink" title="+ initialize"></a>+ initialize</h4><p>在类收到第一条消息的时候初始化这个类。（即第一次使用这个类的时候，调用这个方法。如果项目中没有使用这个类，这个方法不会被调用）</p>
<h5 id="方法声明"><a href="#方法声明" class="headerlink" title="方法声明"></a>方法声明</h5><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">+ (<span class="keyword">void</span>)initialize</span><br></pre></td></tr></table></figure>
<h5 id="讨论"><a href="#讨论" class="headerlink" title="讨论"></a>讨论</h5><p>在类或者子类收到第一条消息前，运行时向每个类发送 <em>initialize</em>消息。父类在子类之前收到这个消息。运行时向这些类发送 <em>initialize</em>消息是线程安全的。也就是当第一个线程向一个类发送消息的时候，其他的线程如果想这个类发送消息就会被阻塞，知道第一个线程的消息结束。</p>
<p>如果子类没有实现 <em>initialize</em> 方法，父类中的 <em>initialize</em> 方法可能会被调用多次。如果你想让父类中的 <em>initialize</em> 方法只调用一次，可以使用下面的结构：<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">+ (<span class="keyword">void</span>)initialize &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span> == [ClassName <span class="keyword">self</span>]) &#123;</span><br><span class="line">    <span class="comment">// ... do the initialization ...</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>因为 <em>initialize</em> 是以阻塞的方式调用的，所以要控制好该方法中的工作量。尽量避免在该方法中使用线程锁，因为这可能导致死锁。除此之外，尽量减少在该方法中执行复杂的操作。</p>
<h5 id="附加"><a href="#附加" class="headerlink" title="附加"></a>附加</h5><p>每个类只会调用一次 <em>initialize</em> 方法，如果你想独立的初始化一个类或者该类的类目，那么应该实现<em>+ load</em> 方法。</p>
<h4 id="load"><a href="#load" class="headerlink" title="+ load"></a>+ load</h4><p>当类或者是类目被添加到运行时的时候，就会调用该方法。如果想对类做一些特别的处理，那么可以实现 <em>+load</em>方法。</p>
<h5 id="方法声明-1"><a href="#方法声明-1" class="headerlink" title="方法声明"></a>方法声明</h5><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">+ (<span class="keyword">void</span>)load;</span><br></pre></td></tr></table></figure>
<h5 id="讨论-1"><a href="#讨论-1" class="headerlink" title="讨论"></a>讨论</h5><p>初始化方法调用的顺序：</p>
<ul>
<li>父类的 <em>+ load</em> 方法先于子类的<em>+load</em> 方法调用；</li>
<li>子类的 <em>+load</em> 方法先于类目的调用</li>
</ul>
<p><strong> 这里有一部分官方文档没看懂，先记记录调用顺序吧</strong></p>
<h3 id="创建、拷贝和销毁对象"><a href="#创建、拷贝和销毁对象" class="headerlink" title="创建、拷贝和销毁对象"></a>创建、拷贝和销毁对象</h3><h4 id="alloc"><a href="#alloc" class="headerlink" title="+ alloc"></a>+ alloc</h4><p>为接收该消息者创建一个实例。</p>
<h5 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h5><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TheClass *newObject = [[TheClass alloc] init];</span><br></pre></td></tr></table></figure>
<h5 id="讨论-2"><a href="#讨论-2" class="headerlink" title="讨论"></a>讨论</h5><ul>
<li>如果你想要初始化类中的某些东西，不要重写这个方法，应该去重写 init 方法</li>
<li>因为历史原因， <em>alloc</em> 方法会调用 <em>allocWithZone:</em> 这个方法</li>
</ul>
<h4 id="allocWithZone"><a href="#allocWithZone" class="headerlink" title="+ allocWithZone:"></a>+ allocWithZone:</h4><p>为接收该消息者创建一个实例。</p>
<h5 id="方法声明-2"><a href="#方法声明-2" class="headerlink" title="方法声明"></a>方法声明</h5><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">+ (<span class="keyword">instancetype</span>)allocWithZone:(<span class="keyword">struct</span> _NSZone *)zone;</span><br></pre></td></tr></table></figure>
<p>参数 <em>zone</em> 被忽略了已经</p>
<h5 id="示例-1"><a href="#示例-1" class="headerlink" title="示例"></a>示例</h5><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TheClass *newObject = [[TheClass allocWithZone:<span class="literal">nil</span>] init];</span><br></pre></td></tr></table></figure>
<h5 id="讨论-3"><a href="#讨论-3" class="headerlink" title="讨论"></a>讨论</h5><ul>
<li>如果你想要初始化类中的某些东西，不要重写这个方法，应该去重写 init 方法</li>
<li>这个方法的存在是历史遗留问题， memory zone 在 OC 中已经被丢弃了。</li>
</ul>
<h4 id="init"><a href="#init" class="headerlink" title="- init"></a>- init</h4><p>当一个对象分配到一块内存之后，这个方法用来初始化这个对象，并将初始化之后的对象返回</p>
<h5 id="方法声明-3"><a href="#方法声明-3" class="headerlink" title="方法声明"></a>方法声明</h5><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">instancetype</span>)init;</span><br></pre></td></tr></table></figure>
<h5 id="返回值"><a href="#返回值" class="headerlink" title="返回值"></a>返回值</h5><p>两种情况：</p>
<ul>
<li>初始化之后的对象；</li>
<li>nil ,如果在初始化的过程中出现未知异常，该方法可能会返回 nil<h5 id="讨论-4"><a href="#讨论-4" class="headerlink" title="讨论"></a>讨论</h5><em>init</em> 方法是和 <em>alloc</em>（或者 *allocWithZone:) 方法一起调用的。<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SomeClass *object = [[SomeClass alloc] init];</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>一个对象如果没有通过（init） 方法初始化是不可以被使用的（也就是不可以接受消息）。<br>如果想要自定义这个方法的实现，首先要调用父类的 <em>init</em> 方法，然后再去做你自己的初始化以及返回一个新的对象。如果这个新对象没有初始化成功，那么必须返回 nil。比如，一个 <em>BuiltInCamera</em> 在一部没有摄像头的手机上运行时，初始化方法只能返回 nil。</p>
<h5 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h5><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">instancetype</span>)init &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span> = [<span class="keyword">super</span> init]) &#123;</span><br><span class="line">    <span class="comment">// Initialize self</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在 Xcode 中写 init 方法的时候 ，只需要输入 init 几个字母之后，就可以看到完整的方法提示了，注意不要输入 “-” 否则提示就不会出现了。</p>
<h4 id="copy"><a href="#copy" class="headerlink" title="- copy"></a>- copy</h4><p>调用该方法，会返回一个 <em>copyWithZone</em> 方法的结果</p>
<h5 id="方法声明-4"><a href="#方法声明-4" class="headerlink" title="方法声明"></a>方法声明</h5><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">id</span>)<span class="keyword">copy</span>;</span><br></pre></td></tr></table></figure>
<h5 id="返回值-1"><a href="#返回值-1" class="headerlink" title="返回值"></a>返回值</h5><p>这个返回值是 <em>NSCopying</em> 协议中的 <em>copyWithZone:</em> 方法的返回值</p>
<h5 id="讨论-5"><a href="#讨论-5" class="headerlink" title="讨论"></a>讨论</h5><p>这个方法很方便的让类可以实现 <em>NSCopying</em>协议。 如果调用 <em>copy</em>方法的类没有实现 <em>NSCopying</em>协议，那么就会抛出异常。<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[Whale copyWithZone:]: unrecognized selector sent to instance 0x60400000ecc0'</span><br></pre></td></tr></table></figure></p>
<p>Whale 这个类没有实现 copyWithZone: 这个方法，解决方法就是：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Whale.h</span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Whale</span> : <span class="title">NSObject</span>&lt;<span class="title">NSCopying</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Whale.m</span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"Whale.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">Whale</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">id</span>)copyWithZone:(<span class="built_in">NSZone</span> *)zone &#123;</span><br><span class="line">    <span class="keyword">return</span>  <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p>当然，如果缺少了 <em>@interface Whale : NSObject<nscopying></nscopying></em> 也是可以的，因为我们实现了 <em>copyWithZone:</em> 这个方法。此时程序不会报错。<br>值得注意的是， <em>NSObject</em> 类并不支持 <em>NSCopying</em> 协议，但是子类必须支持此协议，并且实现 <em>copyWithZone:</em> 这个方法，当然前提是你如果想要调用 <em>copy</em> 方法。<br> 如果子类不是直接继承了 NSObject 类，那么在实现<em>copyWithZone:</em> 方法的时候，首先要调用父类的<em>copyWithZone:</em> 方法，将父类的实现合并到子类中。例如， Whale 继承自 NSObject 那么它就不需要调用父类的 <em>copyWithZone:</em> ，但是 AliceWhale 继承自 Whale 类，那么就必须先调用父类的*copyWithZone:方法 ,合并父类的copy 内容：</p>
 <figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">AliceWhale</span> : <span class="title">Whale</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">AliceWhale</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">id</span>)copyWithZone:(<span class="built_in">NSZone</span> *)zone &#123;</span><br><span class="line">    [<span class="keyword">super</span> copyWithZone:zone];</span><br><span class="line">    <span class="keyword">return</span>  <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<h4 id="copyWithZone"><a href="#copyWithZone" class="headerlink" title="-copyWithZone:"></a>-copyWithZone:</h4><p>  没啥好说的<br>  <strong>This method exists so class objects can be used in situations where you need an object that conforms to the NSCopying protocol. For example, this method lets you use a class object as a key to an NSDictionary object. You should not override this method.</strong><br>  这一段话以后再去理解吧，没看懂。</p>
<h4 id="mutableCopy"><a href="#mutableCopy" class="headerlink" title="- mutableCopy"></a>- mutableCopy</h4><p>  返回 mutableCopyWithZone: 的返回值<br>  具体使用逻辑和 copy 类似，只是一个是不可变的一个是可变的</p>
<h4 id="dealloc"><a href="#dealloc" class="headerlink" title="- dealloc"></a>- dealloc</h4><p>  取消对象占用的内存的时候调用这个方法。</p>
<h5 id="讨论-6"><a href="#讨论-6" class="headerlink" title="讨论"></a>讨论</h5><ul>
<li>在该方法的实现中释放一些资源；</li>
<li>不能直接调用此方法，该方法是runtime调用具体参见<a href="https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/MemoryMgmt/Articles/MemoryMgmt.html#//apple_ref/doc/uid/10000011-SW1" target="_blank" rel="noopener">Advanced Memory Management Programming Guide</a></li>
<li>ARC 下不能 [super dealloc]<ul>
<li>MRC 下必须调用 [super dealloc]，而且必须写在方法最后</li>
</ul>
</li>
</ul>
<hr>
<h3 id="识别类"><a href="#识别类" class="headerlink" title="识别类"></a>识别类</h3><p>这里主要有三个类方法</p>
<ul>
<li>+ class , 返回类对象</li>
<li>+ superclass， 返回父类类对象</li>
<li>+ isSubclassOfClass: ， 返回一个 Boolean 值，</li>
</ul>
<h4 id="class"><a href="#class" class="headerlink" title="+ class"></a>+ class</h4><p>返回 类对象</p>
<h5 id="讨论-7"><a href="#讨论-7" class="headerlink" title="讨论"></a>讨论</h5><p>要引用一个类，必须通过类的名字，初次之外其他的情况我们可以通过这个方法来获取一个类对象。</p>
<h4 id="superclass"><a href="#superclass" class="headerlink" title="+ superclass"></a>+ superclass</h4><p>返回父类的类对象</p>
<h4 id="isSubclassOfClass"><a href="#isSubclassOfClass" class="headerlink" title="+isSubclassOfClass:"></a>+isSubclassOfClass:</h4><p>验证调用该方法的类是否继承自参数给定的类（包括父类的父类也会返回YES）</p>
<h3 id="检测实例方法"><a href="#检测实例方法" class="headerlink" title="检测实例方法"></a>检测实例方法</h3><h4 id="instancesRespondToSelector"><a href="#instancesRespondToSelector" class="headerlink" title="+ instancesRespondToSelector:"></a>+ instancesRespondToSelector:</h4><p>返回一个BOOL值，来表示实例是否能够相应方法</p>
<h4 id="方法声明-5"><a href="#方法声明-5" class="headerlink" title="方法声明"></a>方法声明</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">+ (<span class="built_in">BOOL</span>)instancesRespondToSelector:(SEL)aSelector;</span><br></pre></td></tr></table></figure>
<h4 id="讨论-8"><a href="#讨论-8" class="headerlink" title="讨论"></a>讨论</h4><p>该方法检测调用类中是否实现了某个实例方法（aSelector），而不是类方法，如果要检测类方法，那么可以调用协议<nsobect> 中的 <em>respondsToSelector:</em> 方法。<br>如果只是在 .h 文件中声明了该方法，而没有在 .m 中去实现这个方法，检测结果为 NO。</nsobect></p>
<hr>
<h4 id="检测协议"><a href="#检测协议" class="headerlink" title="检测协议"></a>检测协议</h4><p>返回一个BOOL值， 来表示调用该方法的类是否实现了对应的协议（参数）</p>
<h5 id="声明"><a href="#声明" class="headerlink" title="声明"></a>声明</h5><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">+ (<span class="built_in">BOOL</span>)conformsToProtocol:(Protocol *)protocol;</span><br></pre></td></tr></table></figure>
<h5 id="使用示例"><a href="#使用示例" class="headerlink" title="使用示例"></a>使用示例</h5><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">BOOL</span> canJoin = [MyClass conformsToProtocol:<span class="class"><span class="keyword">@protocol</span>(<span class="title">Joining</span>)];</span></span><br></pre></td></tr></table></figure>
<h5 id="讨论-9"><a href="#讨论-9" class="headerlink" title="讨论"></a>讨论</h5><ol>
<li><p>MyClass  实现了 AffiliationRequests  和 AffiliationRequests 协议</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">MyClass</span> : <span class="title">NSObject</span> &lt;<span class="title">AffiliationRequests</span>, <span class="title">Normalization</span>&gt;</span></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>协议之间的合并 AffiliationRequests 合并了 Joining 协议</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@protocol</span> <span class="title">AffiliationRequests</span> &lt;<span class="title">Joining</span>&gt;</span></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>如果 MyClass 实现了AffiliationRequests协议，同样实现了 Joining， <em>conformsToProtocol</em> 返回结果为YES</p>
</li>
<li><em>conformsToProtocol：</em> 该方法不会检测程序有没有实现协议中的方法，只会检测在类的声明后面有没有<protocol name="">。</protocol></li>
<li>即使你实现了协议的方法，但是没有在类的声明后面通过尖括号包含协议的名字，那么该方法返回仍为NO</li>
</ol>
<hr>
<h3 id="获取方法信息"><a href="#获取方法信息" class="headerlink" title="获取方法信息"></a>获取方法信息</h3><h4 id="methodForSelector"><a href="#methodForSelector" class="headerlink" title="- methodForSelector:"></a>- methodForSelector:</h4><p>返回方法实现的地址</p>
<h5 id="方法声明-6"><a href="#方法声明-6" class="headerlink" title="方法声明"></a>方法声明</h5><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- (IMP)methodForSelector:(SEL)aSelector;</span><br></pre></td></tr></table></figure>
<p><em>IMP</em> 方法（函数）指针，也就是实现方法的地址<br>参数 <em>aSelector</em>必须合法，在传入作为参数之前，可以通过 <em>responseToSelector</em> 检查该参数指向的方法是否已经实现了</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">MethodInfor *mObj = [MethodInfor new];</span><br><span class="line"><span class="keyword">if</span> ([mObj respondsToSelector:<span class="keyword">@selector</span>(sayHello)]) &#123;</span><br><span class="line">    IMP imp = [mObj methodForSelector:<span class="keyword">@selector</span>(sayHello)];</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%p"</span>,imp);</span><br><span class="line">    imp();<span class="comment">// 执行了 sayHello 方法</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="讨论-10"><a href="#讨论-10" class="headerlink" title="讨论"></a>讨论</h5><p>方法的调用者如果是 类 那么 aSelector 必须是类方法；<br>方法的调用者如果是 实例 那么 aSelector 必须是实例方法</p>
<h4 id="instanceMethodForSelector"><a href="#instanceMethodForSelector" class="headerlink" title="+ instanceMethodForSelector:"></a>+ instanceMethodForSelector:</h4><p>返回实例方法实现的地址</p>
<h5 id="方法声明-7"><a href="#方法声明-7" class="headerlink" title="方法声明"></a>方法声明</h5><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">+ (IMP)instanceMethodForSelector:(SEL)aSelector;</span><br></pre></td></tr></table></figure>
<p><em>IMP</em> 方法（函数）指针，也就是实现方法的地址<br>参数 <em>aSelector</em>必须合法，在传入作为参数之前，可以通过 <em>instanceMethodForSelector</em> 检查该参数指向的方法是否已经实现了</p>
<h5 id="示例-2"><a href="#示例-2" class="headerlink" title="示例"></a>示例</h5><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ([MethodInfor instancesRespondToSelector:<span class="keyword">@selector</span>(sayHello)]  ) &#123;</span><br><span class="line">    IMP imp = [MethodInfor instanceMethodForSelector:<span class="keyword">@selector</span>(sayHello)];</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%p"</span>,imp);</span><br><span class="line">    imp();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="讨论-11"><a href="#讨论-11" class="headerlink" title="讨论"></a>讨论</h5><p>该方法只用来检测 类 中的实例有没有实现实例方法，不能检测类方法。检测类方法使用 <em>methodForSelector:</em> 。</p>
<h4 id="instanceMethodSignatureForSelector"><a href="#instanceMethodSignatureForSelector" class="headerlink" title="+ instanceMethodSignatureForSelector:"></a>+ instanceMethodSignatureForSelector:</h4><p>返回方法签名对象<a href="https://developer.apple.com/documentation/foundation/nsmethodsignature?language=occ" target="_blank" rel="noopener">NSMethodSignature</a></p>
<h5 id="方法声明-8"><a href="#方法声明-8" class="headerlink" title="方法声明"></a>方法声明</h5><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">+ (<span class="built_in">NSMethodSignature</span> *)instanceMethodSignatureForSelector:(SEL)aSelector;</span><br></pre></td></tr></table></figure>
<h5 id="示例-3"><a href="#示例-3" class="headerlink" title="示例"></a>示例</h5><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSMethodSignature</span> *sayHelloSignature = [MethodInfor instanceMethodSignatureForSelector:<span class="keyword">@selector</span>(sayHello)];</span><br></pre></td></tr></table></figure>
<h5 id="讨论-12"><a href="#讨论-12" class="headerlink" title="讨论"></a>讨论</h5><p>该方法会返回一个方法的签名对象，如果类的对象不能响应这个方法，那么会返回一个 nil 对象。</p>
<h4 id="methodSignatureForSelector"><a href="#methodSignatureForSelector" class="headerlink" title="- methodSignatureForSelector:"></a>- methodSignatureForSelector:</h4><p>返回方法签名对象<a href="https://developer.apple.com/documentation/foundation/nsmethodsignature?language=occ" target="_blank" rel="noopener">NSMethodSignature</a></p>
<h5 id="方法声明-9"><a href="#方法声明-9" class="headerlink" title="方法声明"></a>方法声明</h5><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">NSMethodSignature</span> *)methodSignatureForSelector:(SEL)aSelector;</span><br></pre></td></tr></table></figure>
<h5 id="示例-4"><a href="#示例-4" class="headerlink" title="示例"></a>示例</h5><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSMethodSignature</span> *sayHelloSignature = [MethodInfor instanceMethodSignatureForSelector:<span class="keyword">@selector</span>(sayHello)];</span><br></pre></td></tr></table></figure>
<h5 id="讨论-13"><a href="#讨论-13" class="headerlink" title="讨论"></a>讨论</h5><p>该方法会返回一个方法的签名对象，如果类的对象不能响应这个方法，那么会返回一个 nil 对象。<br>该方法针对类和对象都可以。<br>这里与<br><em>This method is used in the implementation of protocols. This method is also used in situations where an NSInvocation object must be created, such as during message forwarding. If your object maintains a delegate or is capable of handling messages that it does not directly implement, you should override this method to return an appropriate method signature.</em> 没看懂，等了解了 NSInvocation 之后再来看看。</p>

          
        
      
    </div>
    
    
    

    <div>
      
    </div>
    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/06/01/Pre/SQLite-FTS3-and-FTS4-Extensions/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Alice">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hi, this is Alice Home">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/06/01/Pre/SQLite-FTS3-and-FTS4-Extensions/" itemprop="url">SQLite FTS3 and FTS4 Extensions</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-06-01T11:07:27+08:00">
                2015-06-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/DataBase/" itemprop="url" rel="index">
                    <span itemprop="name">DataBase</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><h2 id="Ref"><a href="#Ref" class="headerlink" title="Ref"></a>Ref</h2><ol>
<li><a href="http://www.sqlite.org/fts3.html" target="_blank" rel="noopener">SQLite FTS3 and FTS4 Extensions</a></li>
</ol>

          
        
      
    </div>
    
    
    

    <div>
      
    </div>
    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/02/02/Pre/iOS 问题札记/iOS-开发-Tips/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Alice">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hi, this is Alice Home">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/02/02/Pre/iOS 问题札记/iOS-开发-Tips/" itemprop="url">iOS 开发 Tips</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-02-02T11:47:34+08:00">
                2015-02-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS/" itemprop="url" rel="index">
                    <span itemprop="name">iOS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>记录在开发过程中的一些小技巧的使用</p>
<h2 id="TableView"><a href="#TableView" class="headerlink" title="TableView"></a>TableView</h2><h3 id="取消-table-view-的-section-悬停"><a href="#取消-table-view-的-section-悬停" class="headerlink" title="取消 table view 的 section 悬停"></a>取消 <em>table view</em> 的 <em>section</em> 悬停</h3><p>有时候，通过使用 <em>sectionView</em> 实现tableView的间隔效果，但是不想让这个间隔悬停。<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)scrollViewDidScroll:(<span class="built_in">UIScrollView</span> *)scrollView &#123;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">CGFloat</span> sectionHeaderHeight = <span class="number">12</span>;</span><br><span class="line">    <span class="keyword">if</span> (scrollView.contentOffset.y&lt;=sectionHeaderHeight&amp;&amp;scrollView.contentOffset.y&gt;=<span class="number">0</span>) &#123;</span><br><span class="line">        scrollView.contentInset = <span class="built_in">UIEdgeInsetsMake</span>(-scrollView.contentOffset.y, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (scrollView.contentOffset.y&gt;=sectionHeaderHeight) &#123;</span><br><span class="line">        scrollView.contentInset = <span class="built_in">UIEdgeInsetsMake</span>(-sectionHeaderHeight, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="tableView-中有输入框，键盘隐藏-UITableViewController-的效果"><a href="#tableView-中有输入框，键盘隐藏-UITableViewController-的效果" class="headerlink" title="tableView 中有输入框，键盘隐藏 - UITableViewController 的效果"></a>tableView 中有输入框，键盘隐藏 - UITableViewController 的效果</h3><p>通过实现UITableViewController中控制键盘的效果，又不使用UITableViewController</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">UITableView</span> *)tableView &#123;</span><br><span class="line">    <span class="keyword">if</span> (!_tableView) &#123;</span><br><span class="line"></span><br><span class="line">        _tableView = [[<span class="built_in">UITableView</span> alloc] initWithFrame:<span class="built_in">CGRectZero</span> style:<span class="built_in">UITableViewStylePlain</span>];</span><br><span class="line">        <span class="comment">//处理键盘弹出tableView自动像是移动一段距离</span></span><br><span class="line">        <span class="built_in">UITableViewController</span> *tvc = [[<span class="built_in">UITableViewController</span> alloc] initWithStyle:<span class="built_in">UITableViewStylePlain</span>];</span><br><span class="line">        [<span class="keyword">self</span> addChildViewController:tvc];</span><br><span class="line">        _tableView = tvc.tableView;</span><br><span class="line"></span><br><span class="line">        _tableView.delegate = <span class="keyword">self</span>;</span><br><span class="line">        _tableView.dataSource = <span class="keyword">self</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> _tableView;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="布局"><a href="#布局" class="headerlink" title="布局"></a>布局</h2><h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2>
          
        
      
    </div>
    
    
    

    <div>
      
    </div>
    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2014/07/10/Pre/FMDB-源码（一）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Alice">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hi, this is Alice Home">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/07/10/Pre/FMDB-源码（一）/" itemprop="url">FMDB 源码（一）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2014-07-10T16:21:11+08:00">
                2014-07-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Database/" itemprop="url" rel="index">
                    <span itemprop="name">Database</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="FMDB-简介"><a href="#FMDB-简介" class="headerlink" title="FMDB 简介"></a>FMDB 简介</h2><h3 id="FMDB-瞎说123"><a href="#FMDB-瞎说123" class="headerlink" title="FMDB 瞎说123"></a>FMDB 瞎说123</h3><p>FMDB 是在 sqlite 的 Objective-C  版本。在 iOS 开发过程中，用到数据库的第三方大部分都会选择这个库，好早之前就用到了，这次抽了时间看看主要实现。</p>
<p>数据库所做的就是 CRUD 操作，那么 FMDB 要做的便是将 sqlite C API 中的 CRUD 操作以及其他数据库的操作转换成 Objective-C 的 API 。</p>
<h3 id="为什么看-FMDB-源码？"><a href="#为什么看-FMDB-源码？" class="headerlink" title="为什么看 FMDB 源码？"></a>为什么看 FMDB 源码？</h3><p>(▼へ▼メ)<br>FMDB 的 REAMDME 大体浏览一遍，其对 ARC 环境编译期间的识别，以及其多线程的安全让我想探究一下他们是如何实现的，是通过什么样的技术去做到的，当然还有一部分就是我想看一下 FMDB 的单元测试是怎么做的，大概总结如下</p>
<ul>
<li>ARC 和 非 ARC 的编译器区分如何实现</li>
<li>多线程安全如何实现</li>
<li>UnitTest 如何去做</li>
<li>FMDB 如何支持 swift 呢？</li>
</ul>
<p>尤其是最后这条，我没有看到 FMDB 有 Swift 的版本，那么他是如何支持 Swift 的呢？</p>
<h2 id="FMDB-结构"><a href="#FMDB-结构" class="headerlink" title="FMDB 结构"></a>FMDB 结构</h2><ol>
<li>FMDatabase Class 主要数据库类，线程安全<h2 id="FMDB-之-FMDatabase-Class"><a href="#FMDB-之-FMDatabase-Class" class="headerlink" title="FMDB 之 FMDatabase Class"></a>FMDB 之 FMDatabase Class</h2></li>
</ol>
<h2 id="读源码学习知识"><a href="#读源码学习知识" class="headerlink" title="读源码学习知识"></a>读源码学习知识</h2><p>这里记录的是学习到 FMDB 解决某些问题的方式</p>
<ul>
<li>ARC 和 非 ARC 区分</li>
<li>可变参数</li>
<li>参数约束</li>
<li>方法丢弃</li>
</ul>
<h3 id="FMDB-如何支持-非-ARC-和-ARC"><a href="#FMDB-如何支持-非-ARC-和-ARC" class="headerlink" title="FMDB 如何支持 非 ARC 和 ARC"></a>FMDB 如何支持 非 ARC 和 ARC</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">#if ! __has_feature(objc_arc)</span><br><span class="line">    #define FMDBAutorelease(__v) ([__v autorelease]);</span><br><span class="line">    #define FMDBReturnAutoreleased FMDBAutorelease</span><br><span class="line"></span><br><span class="line">    #define FMDBRetain(__v) ([__v retain]);</span><br><span class="line">    #define FMDBReturnRetained FMDBRetain</span><br><span class="line"></span><br><span class="line">    #define FMDBRelease(__v) ([__v release]);</span><br><span class="line"></span><br><span class="line">    #define FMDBDispatchQueueRelease(__v) (dispatch_release(__v));</span><br><span class="line">#else</span><br><span class="line">    // -fobjc-arc</span><br><span class="line">    #define FMDBAutorelease(__v)</span><br><span class="line">    #define FMDBReturnAutoreleased(__v) (__v)</span><br><span class="line"></span><br><span class="line">    #define FMDBRetain(__v)</span><br><span class="line">    #define FMDBReturnRetained(__v) (__v)</span><br><span class="line"></span><br><span class="line">    #define FMDBRelease(__v)</span><br><span class="line"></span><br><span class="line">#endif</span><br></pre></td></tr></table></figure>
<p>上面这部分代码便是如何实现 ARC 和 非 ARC 情况的宏定义，不错，就是通过宏定义来区分的，看一下实现的代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">+ (instancetype)databaseQueueWithPath:(NSString *)aPath flags:(int)openFlags &#123;</span><br><span class="line">    FMDatabaseQueue *q = [[self alloc] initWithPath:aPath flags:openFlags];</span><br><span class="line">    </span><br><span class="line">    FMDBAutorelease(q);</span><br><span class="line">    </span><br><span class="line">    return q;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在使用的地方，根据 ARC 或者 非 ARC 的情况，因为通过宏定义，如果是使用了 retain 的地方，那么在 ARC 下就是空的，如果使用了自动释放池，那么在 ARC 下便是原样儿不变，除此之外，还有 dealloc 方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">- (void)dealloc &#123;</span><br><span class="line">    FMDBRelease(_db);</span><br><span class="line">    FMDBRelease(_path);</span><br><span class="line">    FMDBRelease(_vfsName);</span><br><span class="line">    </span><br><span class="line">    if (_queue) &#123;</span><br><span class="line">        FMDBDispatchQueueRelease(_queue);</span><br><span class="line">        _queue = 0x00;</span><br><span class="line">    &#125;</span><br><span class="line">#if ! __has_feature(objc_arc)</span><br><span class="line">    [super dealloc];</span><br><span class="line">#endif</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="FMDB-如何实现-Objective-C-方法可变参数（两种方式）"><a href="#FMDB-如何实现-Objective-C-方法可变参数（两种方式）" class="headerlink" title="FMDB 如何实现 Objective-C 方法可变参数（两种方式）"></a>FMDB 如何实现 Objective-C 方法可变参数（两种方式）</h3><h4 id="没有格式"><a href="#没有格式" class="headerlink" title="没有格式"></a>没有格式</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- (BOOL)executeUpdate:(NSString*)sql, ...;</span><br></pre></td></tr></table></figure>
<p>这个方法是 FMDB 中用来执行 sql 语句的，对于 sql 中的 insert 语句而言可以做如下执行：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">NSString *inputName = @&quot;Tom&quot;;</span><br><span class="line">NSInteger inputAge = 34;</span><br><span class="line">NSInteger selectGender = 1;</span><br><span class="line"></span><br><span class="line">[db executeUpdate:@&quot;insert into Teacher (name,age,sex) values (?, ?, ?)&quot;,</span><br><span class="line"> inputName,</span><br><span class="line"> @(inputAge),</span><br><span class="line"> @(selectGender)];</span><br></pre></td></tr></table></figure>
<p>这里就是可变参数了，而且参数没有限制。怎么实现的呢 ？</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">- (BOOL)executeUpdate:(NSString*)sql, ... &#123;</span><br><span class="line">    va_list args;</span><br><span class="line">    va_start(args, sql);</span><br><span class="line">    </span><br><span class="line">    BOOL result = [self executeUpdate:sql error:nil withArgumentsInArray:nil orDictionary:nil orVAList:args];</span><br><span class="line">    </span><br><span class="line">    va_end(args);</span><br><span class="line">    return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>通过 va_list 这种宏定义方式进行解析，而且 sql 语句貌似可以直接接受 va_list 参数</p>
<h4 id="有格式"><a href="#有格式" class="headerlink" title="有格式"></a>有格式</h4><p>什么是有格式呢 ？ </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- (BOOL)executeUpdateWithFormat:(NSString *)format, ... NS_FORMAT_FUNCTION(1,2);</span><br></pre></td></tr></table></figure>
<p>怎么使用呢 ？</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[db executeUpdateWithFormat:@&quot;insert into Teacher (name,age,sex) values (%@, %d, %d)&quot;,inputName,inputAge,selectGender];</span><br></pre></td></tr></table></figure>
<p>可以看到，这种模式我们并不陌生，我们称之为：格式化字符串。像 NSString 就有这么一个方法，我们经常在用：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">+ (instancetype)stringWithFormat:(NSString *)format, ... NS_FORMAT_FUNCTION(1,2);</span><br><span class="line">+ (instancetype)localizedStringWithFormat:(NSString *)format, ... NS_FORMAT_FUNCTION(1,2);</span><br></pre></td></tr></table></figure>
<p>这里是在方法声明的后面添加了 <strong>NS_FORMAT_FUNCTION(1,2)</strong> 一个宏定义便 OK 了，那么如何解析这些参数呢？</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">- (BOOL)executeUpdateWithFormat:(NSString*)format, ... &#123;</span><br><span class="line">    va_list args;</span><br><span class="line">    va_start(args, format);</span><br><span class="line">    </span><br><span class="line">    NSMutableString *sql      = [NSMutableString stringWithCapacity:[format length]];</span><br><span class="line">    NSMutableArray *arguments = [NSMutableArray array];</span><br><span class="line">    </span><br><span class="line">    [self extractSQL:format argumentsList:args intoString:sql arguments:arguments];</span><br><span class="line">    </span><br><span class="line">    va_end(args);</span><br><span class="line">    </span><br><span class="line">    return [self executeUpdate:sql withArgumentsInArray:arguments];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>是的和上面的解析方式一样，但是我们要看到如何解析到字符串和数字呢？</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line">- (void)extractSQL:(NSString *)sql argumentsList:(va_list)args intoString:(NSMutableString *)cleanedSQL arguments:(NSMutableArray *)arguments &#123;</span><br><span class="line">    </span><br><span class="line">    NSUInteger length = [sql length];</span><br><span class="line">    unichar last = &apos;\0&apos;;</span><br><span class="line">    for (NSUInteger i = 0; i &lt; length; ++i) &#123;</span><br><span class="line">        id arg = nil;</span><br><span class="line">        unichar current = [sql characterAtIndex:i];</span><br><span class="line">        unichar add = current;</span><br><span class="line">        if (last == &apos;%&apos;) &#123;</span><br><span class="line">            switch (current) &#123;</span><br><span class="line">                case &apos;@&apos;:</span><br><span class="line">                    arg = va_arg(args, id);</span><br><span class="line">                    break;</span><br><span class="line">                case &apos;c&apos;:</span><br><span class="line">                    // warning: second argument to &apos;va_arg&apos; is of promotable type &apos;char&apos;; this va_arg has undefined behavior because arguments will be promoted to &apos;int&apos;</span><br><span class="line">                    arg = [NSString stringWithFormat:@&quot;%c&quot;, va_arg(args, int)];</span><br><span class="line">                    break;</span><br><span class="line">                case &apos;s&apos;:</span><br><span class="line">                    arg = [NSString stringWithUTF8String:va_arg(args, char*)];</span><br><span class="line">                    break;</span><br><span class="line">                case &apos;d&apos;:</span><br><span class="line">                case &apos;D&apos;:</span><br><span class="line">                case &apos;i&apos;:</span><br><span class="line">                    arg = [NSNumber numberWithInt:va_arg(args, int)];</span><br><span class="line">                    break;</span><br><span class="line">                case &apos;u&apos;:</span><br><span class="line">                case &apos;U&apos;:</span><br><span class="line">                    arg = [NSNumber numberWithUnsignedInt:va_arg(args, unsigned int)];</span><br><span class="line">                    break;</span><br><span class="line">                case &apos;h&apos;:</span><br><span class="line">                    i++;</span><br><span class="line">                    if (i &lt; length &amp;&amp; [sql characterAtIndex:i] == &apos;i&apos;) &#123;</span><br><span class="line">                        //  warning: second argument to &apos;va_arg&apos; is of promotable type &apos;short&apos;; this va_arg has undefined behavior because arguments will be promoted to &apos;int&apos;</span><br><span class="line">                        arg = [NSNumber numberWithShort:(short)(va_arg(args, int))];</span><br><span class="line">                    &#125;</span><br><span class="line">                    else if (i &lt; length &amp;&amp; [sql characterAtIndex:i] == &apos;u&apos;) &#123;</span><br><span class="line">                        // warning: second argument to &apos;va_arg&apos; is of promotable type &apos;unsigned short&apos;; this va_arg has undefined behavior because arguments will be promoted to &apos;int&apos;</span><br><span class="line">                        arg = [NSNumber numberWithUnsignedShort:(unsigned short)(va_arg(args, uint))];</span><br><span class="line">                    &#125;</span><br><span class="line">                    else &#123;</span><br><span class="line">                        i--;</span><br><span class="line">                    &#125;</span><br><span class="line">                    break;</span><br><span class="line">                case &apos;q&apos;:</span><br><span class="line">                    i++;</span><br><span class="line">                    if (i &lt; length &amp;&amp; [sql characterAtIndex:i] == &apos;i&apos;) &#123;</span><br><span class="line">                        arg = [NSNumber numberWithLongLong:va_arg(args, long long)];</span><br><span class="line">                    &#125;</span><br><span class="line">                    else if (i &lt; length &amp;&amp; [sql characterAtIndex:i] == &apos;u&apos;) &#123;</span><br><span class="line">                        arg = [NSNumber numberWithUnsignedLongLong:va_arg(args, unsigned long long)];</span><br><span class="line">                    &#125;</span><br><span class="line">                    else &#123;</span><br><span class="line">                        i--;</span><br><span class="line">                    &#125;</span><br><span class="line">                    break;</span><br><span class="line">                case &apos;f&apos;:</span><br><span class="line">                    arg = [NSNumber numberWithDouble:va_arg(args, double)];</span><br><span class="line">                    break;</span><br><span class="line">                case &apos;g&apos;:</span><br><span class="line">                    // warning: second argument to &apos;va_arg&apos; is of promotable type &apos;float&apos;; this va_arg has undefined behavior because arguments will be promoted to &apos;double&apos;</span><br><span class="line">                    arg = [NSNumber numberWithFloat:(float)(va_arg(args, double))];</span><br><span class="line">                    break;</span><br><span class="line">                case &apos;l&apos;:</span><br><span class="line">                    i++;</span><br><span class="line">                    if (i &lt; length) &#123;</span><br><span class="line">                        unichar next = [sql characterAtIndex:i];</span><br><span class="line">                        if (next == &apos;l&apos;) &#123;</span><br><span class="line">                            i++;</span><br><span class="line">                            if (i &lt; length &amp;&amp; [sql characterAtIndex:i] == &apos;d&apos;) &#123;</span><br><span class="line">                                //%lld</span><br><span class="line">                                arg = [NSNumber numberWithLongLong:va_arg(args, long long)];</span><br><span class="line">                            &#125;</span><br><span class="line">                            else if (i &lt; length &amp;&amp; [sql characterAtIndex:i] == &apos;u&apos;) &#123;</span><br><span class="line">                                //%llu</span><br><span class="line">                                arg = [NSNumber numberWithUnsignedLongLong:va_arg(args, unsigned long long)];</span><br><span class="line">                            &#125;</span><br><span class="line">                            else &#123;</span><br><span class="line">                                i--;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                        else if (next == &apos;d&apos;) &#123;</span><br><span class="line">                            //%ld</span><br><span class="line">                            arg = [NSNumber numberWithLong:va_arg(args, long)];</span><br><span class="line">                        &#125;</span><br><span class="line">                        else if (next == &apos;u&apos;) &#123;</span><br><span class="line">                            //%lu</span><br><span class="line">                            arg = [NSNumber numberWithUnsignedLong:va_arg(args, unsigned long)];</span><br><span class="line">                        &#125;</span><br><span class="line">                        else &#123;</span><br><span class="line">                            i--;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    else &#123;</span><br><span class="line">                        i--;</span><br><span class="line">                    &#125;</span><br><span class="line">                    break;</span><br><span class="line">                default:</span><br><span class="line">                    // something else that we can&apos;t interpret. just pass it on through like normal</span><br><span class="line">                    break;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        else if (current == &apos;%&apos;) &#123;</span><br><span class="line">            // percent sign; skip this character</span><br><span class="line">            add = &apos;\0&apos;;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        if (arg != nil) &#123;</span><br><span class="line">            [cleanedSQL appendString:@&quot;?&quot;];</span><br><span class="line">            [arguments addObject:arg];</span><br><span class="line">        &#125;</span><br><span class="line">        else if (add == (unichar)&apos;@&apos; &amp;&amp; last == (unichar) &apos;%&apos;) &#123;</span><br><span class="line">            [cleanedSQL appendFormat:@&quot;NULL&quot;];</span><br><span class="line">        &#125;</span><br><span class="line">        else if (add != &apos;\0&apos;) &#123;</span><br><span class="line">            [cleanedSQL appendFormat:@&quot;%C&quot;, add];</span><br><span class="line">        &#125;</span><br><span class="line">        last = current;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>是的，就是这么一个一个的解析出来的</p>
<h3 id="参数约束"><a href="#参数约束" class="headerlink" title="参数约束"></a>参数约束</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">NS_ASSUME_NONNULL_BEGIN</span><br><span class="line">+ (instancetype)databaseWithURL:(NSURL * _Nullable)url;</span><br><span class="line"></span><br><span class="line">- (instancetype)initWithPath:(NSString * _Nullable)path;</span><br><span class="line"></span><br><span class="line">- (instancetype)initWithURL:(NSURL * _Nullable)url;</span><br><span class="line">NS_ASSUME_NONNULL_END</span><br></pre></td></tr></table></figure>
<p>这一对宏中包含的方法中的参数都是必须传入的，否则会报警告，也就是参数不能为 nil。如果，打算让参数可以为 nil 那么就必须在参数类型后面添加 <strong>_Nullable</strong>, FMDB 初始化方法可以不传入 path ，如上实现。</p>
<h3 id="方法丢弃"><a href="#方法丢弃" class="headerlink" title="方法丢弃"></a>方法丢弃</h3><p>这在系统 API 中也经常看到，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">//.h 声明</span><br><span class="line"></span><br><span class="line">- (BOOL)update:(NSString*)sql withErrorAndBindings:(NSError * _Nullable*)outErr, ...  __deprecated_msg(&quot;Use executeUpdate:withErrorAndBindings: instead&quot;);;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//.m 实现</span><br><span class="line"></span><br><span class="line">#pragma clang diagnostic push</span><br><span class="line">#pragma clang diagnostic ignored &quot;-Wdeprecated-implementations&quot;</span><br><span class="line">- (BOOL)update:(NSString*)sql withErrorAndBindings:(NSError**)outErr, ... &#123;</span><br><span class="line">    va_list args;</span><br><span class="line">    va_start(args, outErr);</span><br><span class="line">    </span><br><span class="line">    BOOL result = [self executeUpdate:sql error:outErr withArgumentsInArray:nil orDictionary:nil orVAList:args];</span><br><span class="line">    </span><br><span class="line">    va_end(args);</span><br><span class="line">    return result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#pragma clang diagnostic pop</span><br></pre></td></tr></table></figure>
<h3 id="FMDB-如何支持-Swift-呢？"><a href="#FMDB-如何支持-Swift-呢？" class="headerlink" title="FMDB 如何支持 Swift 呢？"></a>FMDB 如何支持 Swift 呢？</h3><h2 id="FMDB-的单元测试"><a href="#FMDB-的单元测试" class="headerlink" title="FMDB 的单元测试"></a>FMDB 的单元测试</h2><h2 id="如何看源码？"><a href="#如何看源码？" class="headerlink" title="如何看源码？"></a>如何看源码？</h2><p>带着问题去看，带着好奇心去看，快乐的看！<br>看源码是一件很痛苦的事情，因为这就像一场陌生的旅游，或者是到了别人家里一样！比如有一天别人说：</p>
<p>”啊，那么土地真的很美丽，很有魅力，大家都说它多好多好”</p>
<p>你听说了之后，也不知道自己感不感兴趣，也不知道它哪里美，更不知道你去了要做什么，只知道别人说去过那里的人都很 NB ，所以你去了，这不是一场旅行，这是一场灾难，绝对的，因为你对它太陌生了，陌生到你处处碰壁，无路可走。</p>
<p>很多时候，我们觉得漫无目的的浏览风光觉得很好，但是，当你意识到生命的短暂，时间的流逝的时候，让你这么做，那绝对绝对是谋杀了。记得以前总觉得自己总是被枷锁锁住，后来我将枷锁打破，然后自己慢慢的静待时光流逝，我以为这种感觉会很好，但是当时间流逝了一段时间之后，我感到疲惫，感到不安，这就如同我们在看源码的时候，漫无目的的去看，都知道这个框架好，那个代码写的优美，但是你真的懂得怎么去欣赏这里的景色了么？</p>
<p>当你想去买房子的时候，你才会去关注房价，关注房屋设计，关注各个城市之间的区别等等。为此，你猜了解到了，原来房子需要这样那样，原来周边环境也很重要，原来这种材料是一般般的等等的问题。而如果你从未打算去买房子，那么别人邀你一起去看房子，即使那房子再美，我想你看到的也就是那句 “房子不错” 其他的你也许真的真的看不出来了。</p>
<p>所以，如果你打算去看一个源码，那么最好最好准备，你要得到什么，为什么去看，相信我，如果你知道了这些，真的会事半功倍！</p>
<p>就如同现在区块链很火，很多人都去看，算法也很火，很多人都去学，我看到好多人都去分享那些xxxx课程，xxxx讲座，xxxx多少天让你了解，我没有去看过，我只在乎那些我需要的东西。</p>
<p>就如同，我要实现可变参数，我要实现一个库支持 Objective-C 和 Swift 一样，just this！</p>
<p>还有一个原因就是，你永远不可能知道第三方库为什么要写成这样？真的，第三方库为什么要实现这样或者那样的需求，这些事情要问作者，而作者也不会知道，你我都是 coding 的，我们都知道需求写完了之后的事情就是没有问题我们便会会提起！所以好多东西本来便没有了来源，你再怎么看也是那个样子，所以索性让第三方库围绕着你走，你要什么便到里面去寻找就 OK 了。</p>

          
        
      
    </div>
    
    
    

    <div>
      
    </div>
    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2014/06/01/Pre/sqlite-tour/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Alice">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hi, this is Alice Home">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/06/01/Pre/sqlite-tour/" itemprop="url">sqlite tour</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2014-06-01T11:33:21+08:00">
                2014-06-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/DataBase/" itemprop="url" rel="index">
                    <span itemprop="name">DataBase</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>[toc]</p>
<h2 id="sqlite3-program"><a href="#sqlite3-program" class="headerlink" title="sqlite3 program"></a>sqlite3 program</h2><p>Mac OS 上已经预装了 sqlite3 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ which sqlite3</span><br><span class="line">/usr/bin/sqlite3</span><br></pre></td></tr></table></figure>
<p>进入 sqlite3 命令行环境，并创建表格</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$sqlite3 ex1</span><br><span class="line">SQLite version 3.8.5 2014-05-29 12:36:14</span><br><span class="line">Enter &quot;.help&quot; for usage hints.</span><br><span class="line">sqlite&gt; create table tabl2 (</span><br><span class="line">   ...&gt; f1 varchar(30) primary key,</span><br><span class="line">   ...&gt; f2 text,</span><br><span class="line">   ...&gt; f3 real</span><br><span class="line">   ...&gt; );</span><br><span class="line">   </span><br><span class="line">insert into tabl2 values (&apos;Jack&apos;,&apos;male&apos;,12.6);</span><br><span class="line">insert into tabl2 values (&apos;Tome&apos;,&apos;male&apos;,12.6);</span><br><span class="line">insert into tabl2 values (&apos;Bob&apos;,&apos;male&apos;,12.6);</span><br><span class="line">insert into tabl2 values (&apos;Rose&apos;,&apos;fmale&apos;,12.6);</span><br></pre></td></tr></table></figure>
<h2 id="dot-command"><a href="#dot-command" class="headerlink" title="dot-command"></a>dot-command</h2><p>点命令是 sqlite3 的设置输出命令，有一些规则需要遵循：</p>
<ul>
<li>必须以 “.” 开头；</li>
<li>单行执行，不支持多行</li>
<li>不能在 SQL 中</li>
<li>不能够写注释</li>
</ul>
<p>通过 .help 可以查看所有的点命令</p>
<p><strong>注意：</strong></p>
<ul>
<li>sqlite 中 SQL 语句不区分大小写；</li>
<li>每个 SQL 语句都需要分号结束，如果没有分号，Enter 之后，sqlite3 会继续让你输入，知道遇到分号为止</li>
</ul>
<h3 id="dot-command-修改输出格式"><a href="#dot-command-修改输出格式" class="headerlink" title="dot-command 修改输出格式"></a>dot-command 修改输出格式</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; .tables</span><br><span class="line">tabl2</span><br><span class="line">sqlite&gt; select * from tabl2;</span><br><span class="line">Jack|male|12.6</span><br><span class="line">Tome|male|12.6</span><br><span class="line">Bob|male|12.6</span><br><span class="line">Rose|fmale|12.6</span><br></pre></td></tr></table></figure>
<p><em>.tables</em> 查看当前数据库中的表， <em>select </em> from tabl2;<em> 查看 </em>tabl2<em> 表中的数据，并且以 </em>list* 方式展示出来。 sqlite3 program 能够以 8 种方式展示输出结果：</p>
<ul>
<li>csv</li>
<li>column </li>
<li>html</li>
<li>insert</li>
<li>line</li>
<li>list</li>
<li>quote</li>
<li>tabs</li>
<li>tcl</li>
</ul>
<p>通过 .mode [方式名字] 可以修改当前的展示模式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; select * from tabl2;</span><br><span class="line">Jack|male|12.6</span><br><span class="line">Tome|male|12.6</span><br><span class="line">Bob|male|12.6</span><br><span class="line">Rose|fmale|12.6</span><br><span class="line">sqlite&gt; .mode list</span><br><span class="line">sqlite&gt; select * from tabl2;</span><br><span class="line">Jack|male|12.6</span><br><span class="line">Tome|male|12.6</span><br><span class="line">Bob|male|12.6</span><br><span class="line">Rose|fmale|12.6</span><br><span class="line">sqlite&gt; .mode csv</span><br><span class="line">sqlite&gt; select * from tabl2;</span><br><span class="line">Jack,male,12.6</span><br><span class="line">Tome,male,12.6</span><br><span class="line">Bob,male,12.6</span><br><span class="line">Rose,fmale,12.6</span><br><span class="line">sqlite&gt; .mode html</span><br><span class="line">sqlite&gt; select * from tabl2;</span><br><span class="line">&lt;TR&gt;&lt;TD&gt;Jack&lt;/TD&gt;</span><br><span class="line">&lt;TD&gt;male&lt;/TD&gt;</span><br><span class="line">&lt;TD&gt;12.6&lt;/TD&gt;</span><br><span class="line">&lt;/TR&gt;</span><br><span class="line">&lt;TR&gt;&lt;TD&gt;Tome&lt;/TD&gt;</span><br><span class="line">&lt;TD&gt;male&lt;/TD&gt;</span><br><span class="line">&lt;TD&gt;12.6&lt;/TD&gt;</span><br><span class="line">&lt;/TR&gt;</span><br><span class="line">&lt;TR&gt;&lt;TD&gt;Bob&lt;/TD&gt;</span><br><span class="line">&lt;TD&gt;male&lt;/TD&gt;</span><br><span class="line">&lt;TD&gt;12.6&lt;/TD&gt;</span><br><span class="line">&lt;/TR&gt;</span><br><span class="line">&lt;TR&gt;&lt;TD&gt;Rose&lt;/TD&gt;</span><br><span class="line">&lt;TD&gt;fmale&lt;/TD&gt;</span><br><span class="line">&lt;TD&gt;12.6&lt;/TD&gt;</span><br><span class="line">&lt;/TR&gt;</span><br><span class="line">sqlite&gt; .mode tabs</span><br><span class="line">sqlite&gt; select * from tabl2;</span><br><span class="line">Jack	male	12.6</span><br><span class="line">Tome	male	12.6</span><br><span class="line">Bob	male	12.6</span><br><span class="line">Rose	fmale	12.6</span><br></pre></td></tr></table></figure>
<p>默认是 <em>list</em> 模式，上面分别以 <em>list</em>、<em>csv</em>、<em>html</em>、<em>tabs</em> 模式进行展示。<br>除此之外，<em>.separator</em> 可以修改分隔符，比如我们以 “ ~ “ 作为分割</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; .separator &quot; ~ &quot;</span><br><span class="line">sqlite&gt; select * from tabl2;</span><br><span class="line">Jack ~ male ~ 12.6</span><br><span class="line">Tome ~ male ~ 12.6</span><br><span class="line">Bob ~ male ~ 12.6</span><br><span class="line">Rose ~ fmale ~ 12.6</span><br><span class="line">sqlite&gt; .mode list</span><br><span class="line">sqlite&gt; select * from tabl2;</span><br><span class="line">Jack|male|12.6</span><br><span class="line">Tome|male|12.6</span><br><span class="line">Bob|male|12.6</span><br><span class="line">Rose|fmale|12.6</span><br></pre></td></tr></table></figure>
<p>当然，如果通过 <em>.mode</em> 再次修改输出格式的话， <em>.separator</em> 的操作就会被重置，这一点需要注意。</p>
<h3 id="line-amp-column-模式"><a href="#line-amp-column-模式" class="headerlink" title="line &amp; column 模式"></a>line &amp; column 模式</h3><p>通过 <em>.mode line</em> 和 <em>.mode column</em> 可以将输出格式修改成行和列模式，实现如下：</p>
<ul>
<li>行模式</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; .mode line</span><br><span class="line">sqlite&gt; select * from tabl2;</span><br><span class="line">   f1 = Jack</span><br><span class="line">   f2 = male</span><br><span class="line">   f3 = 12.6</span><br><span class="line"></span><br><span class="line">   f1 = Tome</span><br><span class="line">   f2 = male</span><br><span class="line">   f3 = 12.6</span><br><span class="line"></span><br><span class="line">   f1 = Bob</span><br><span class="line">   f2 = male</span><br><span class="line">   f3 = 12.6</span><br><span class="line"></span><br><span class="line">   f1 = Rose</span><br><span class="line">   f2 = fmale</span><br><span class="line">   f3 = 12.6</span><br></pre></td></tr></table></figure>
<ul>
<li>列模式</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; .mode column</span><br><span class="line">sqlite&gt; select * from tabl2;</span><br><span class="line">Jack        male        12.6</span><br><span class="line">Tome        male        12.6</span><br><span class="line">Bob         male        12.6</span><br><span class="line">Rose        fmale       12.6</span><br></pre></td></tr></table></figure>
<p>通过 <em>.header on/off</em>  列模式可以将 <em>header</em> 部分展示出来</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; .header on</span><br><span class="line">sqlite&gt; select * from tabl2;</span><br><span class="line">f1          f2          f3</span><br><span class="line">----------  ----------  ----------</span><br><span class="line">Jack        male        12.6</span><br><span class="line">Tome        male        12.6</span><br><span class="line">Bob         male        12.6</span><br><span class="line">Rose        fmale       12.6</span><br></pre></td></tr></table></figure>
<p>修改列宽 <em>.width col1W col2W … colnW</em></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; .width 1 10</span><br><span class="line">sqlite&gt; .mode column</span><br><span class="line">sqlite&gt; select * from tabl2;</span><br><span class="line">f  f2          f3</span><br><span class="line">-  ----------  ----------</span><br><span class="line">J  male        12.6</span><br><span class="line">T  male        12.6</span><br><span class="line">B  male        12.6</span><br><span class="line">R  fmale       12.6</span><br><span class="line">sqlite&gt; .width 10 10 10</span><br><span class="line">sqlite&gt; select * from tabl2;</span><br><span class="line">f1          f2          f3</span><br><span class="line">----------  ----------  ----------</span><br><span class="line">Jack        male        12.6</span><br><span class="line">Tome        male        12.6</span><br><span class="line">Bob         male        12.6</span><br><span class="line">Rose        fmale       12.6</span><br></pre></td></tr></table></figure>
<p><em>.width</em> 后面跟着的数字分别表示第几行的宽度，如果没有就是没有限制</p>
<h3 id="插入模式输出"><a href="#插入模式输出" class="headerlink" title="插入模式输出"></a>插入模式输出</h3><p>有时候，我们需要在另一个表中插入与当前表相同的数据，那么久可以通过 <em>insert</em> 模式来实现</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; .mode insert new_table</span><br><span class="line">sqlite&gt; select * from tabl2;</span><br><span class="line">INSERT INTO new_table(f1,f2,f3) VALUES(&apos;Jack&apos;,&apos;male&apos;,12.599999999999999644);</span><br><span class="line">INSERT INTO new_table(f1,f2,f3) VALUES(&apos;Tome&apos;,&apos;male&apos;,12.599999999999999644);</span><br><span class="line">INSERT INTO new_table(f1,f2,f3) VALUES(&apos;Bob&apos;,&apos;male&apos;,12.599999999999999644);</span><br><span class="line">INSERT INTO new_table(f1,f2,f3) VALUES(&apos;Rose&apos;,&apos;fmale&apos;,12.599999999999999644);</span><br></pre></td></tr></table></figure>
<h3 id="将查询结果写入文件"><a href="#将查询结果写入文件" class="headerlink" title="将查询结果写入文件"></a>将查询结果写入文件</h3><p><em>.output</em> and <em>.once</em> 将 sqlite3 的标准输出重定向到指定文件中</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$touch output.txt</span><br><span class="line"></span><br><span class="line">sqlite&gt; .output output.txt</span><br><span class="line">sqlite&gt; select * from tabl2;</span><br><span class="line"></span><br><span class="line">$ cat output.txt</span><br><span class="line">f1          f2          f3</span><br><span class="line">----------  ----------  ----------</span><br><span class="line">Jack        male        12.6</span><br><span class="line">Tome        male        12.6</span><br><span class="line">Bob         male        12.6</span><br><span class="line">Rose        fmale       12.6</span><br></pre></td></tr></table></figure>
<p><em>.once</em> 用法与 <em>.output</em> 用法一致，只不过 <em>.once</em> 只会让 sliqte3 执行一次非标准输出</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; .once output.txt</span><br><span class="line">sqlite&gt; select * from tabl2;</span><br><span class="line">sqlite&gt; select * from tabl2;</span><br><span class="line">f1          f2          f3</span><br><span class="line">----------  ----------  ----------</span><br><span class="line">Jack        male        12.6</span><br><span class="line">Tome        male        12.6</span><br><span class="line">Bob         male        12.6</span><br><span class="line">Rose        fmale       12.6</span><br></pre></td></tr></table></figure>
<p>通过 ‘|’ 打开保存的文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; .once &apos;|open -f&apos;</span><br><span class="line">sqlite&gt; select * from tabl2;</span><br></pre></td></tr></table></figure>
<p>如图所示，会将结果存储到一个 txt 文件中，然后打开：</p>
<p><img src="/2014/06/01/Pre/sqlite-tour/WX20180601-162145@2x.png" alt=""></p>
<h2 id="File-I-O-Function"><a href="#File-I-O-Function" class="headerlink" title="File I/O Function"></a>File I/O Function</h2><p>以存储图片为例：</p>
<ul>
<li>新建一张 images 表</li>
<li>在当前目录中添加一张图片， icon.png</li>
<li>readfile(‘icon.png’)<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; create table images</span><br><span class="line">   ...&gt; (</span><br><span class="line">   ...&gt; name text,</span><br><span class="line">   ...&gt; type text,</span><br><span class="line">   ...&gt; img blob</span><br><span class="line">   ...&gt; );</span><br><span class="line">sqlite&gt; insert into images(name,type,img) values (&apos;icon&apos;,&apos;png&apos;,readfile(&apos;icon.png&apos;));</span><br><span class="line">sqlite&gt; select  * from images;</span><br><span class="line">name        type        img</span><br><span class="line">----------  ----------  ----------</span><br><span class="line">icon        png         �PNG</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>读取数据库中的图片,writefile(x,y) 负责将图片写入与数据库相同的目录中</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; select writefile(&apos;img.png&apos;,img) from images where name = &apos;icon&apos;;</span><br><span class="line">writefile(&apos;img.png&apos;,img)</span><br><span class="line">------------------------</span><br><span class="line">0</span><br><span class="line">26348</span><br></pre></td></tr></table></figure>
<p>上面实现了 sqlite3 对图片的存储和读取，分别用到了 readfile() 和 writefile() 函数，图片格式为 blob</p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ol>
<li><a href="http://www.sqlite.org/cli.html#getting_started" target="_blank" rel="noopener">Command Line Shell For SQLite</a></li>
<li><a href="http://www.w3school.com.cn/sql/" target="_blank" rel="noopener">W3C-SQL</a></li>
</ol>

          
        
      
    </div>
    
    
    

    <div>
      
    </div>
    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2014/03/01/Pre/2014/Tool/CocoaPods体验/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Alice">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hi, this is Alice Home">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/03/01/Pre/2014/Tool/CocoaPods体验/" itemprop="url">CocoaPods体验</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2014-03-01T09:32:27+08:00">
                2014-03-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CocoaPods/" itemprop="url" rel="index">
                    <span itemprop="name">CocoaPods</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>[TOC]</p>
<h2 id="CocoaPods-Wiki"><a href="#CocoaPods-Wiki" class="headerlink" title="CocoaPods Wiki"></a>CocoaPods Wiki</h2><p>CocoaPods 是一款针对 OC 和 Swift 包以来管理工具（application level dependency manager)。 当然也适合于其他基于 OC 运行时上的语言，比如 RubyMotion，CocoaPods 针对外部扩展库提供了标准格式。它是由 Eloy Duran 和 Fabio Pelosin 以及其他贡献者在 2011 年 8 月开始开发，并在概念 9 月 1 日份发布了第一个版本。 CocoaPods 的健壮性来源于 Ruby 项目 RubyGems 和 Bundler。</p>
<p>CocoaPods 关注于第三方源代码的发布和集成（集成到 Xcode 工程中）。</p>
<p>CocoaPods 在命令行中执行，同样也集成到了 APPCode 的 IDE 中。CocoaPods 通过标准的依赖进行源文件的集成，而不再是通过 Copy 源文件来完成。除此之外，所有的第三方库文件都在一个 git 仓库中进行管理，这个仓库位于 GitHub 上。</p>
<p>CocoaPods 的依赖解决方案来源于 <a href="https://github.com/CocoaPods/Molinillo" target="_blank" rel="noopener">Molinillo</a>, Molinillo 同样被用于其他大型的项目，比如 <a href="https://bundler.io" target="_blank" rel="noopener">Bundler</a>、<a href="https://rubygems.org" target="_blank" rel="noopener">RubyGems</a>、<a href="https://github.com/CocoaPods/Molinillo" target="_blank" rel="noopener">Berkshelf</a>。</p>
<h2 id="CocoaPods-使用总览"><a href="#CocoaPods-使用总览" class="headerlink" title="CocoaPods 使用总览"></a>CocoaPods 使用总览</h2><ul>
<li>第一步： 创建 Xcode 工程</li>
<li>第二部： 在 Xcode 工程的目录下执行： <em>pod init</em></li>
<li>第三步： 如果遇到 <em>command not found: pod</em> 证明没有安装，执行 <em>sudo gem install cocoapods</em> ，输入密码即可,然后重复第二步</li>
<li>第四步：关闭 Xcode 工程，通过 workspace 工程打开，即可， </li>
<li>在 Podfile 中写入依赖库，执行 pod install / update 即可自动集成第三方库</li>
<li>在项目相应的文件中引入库文件即可</li>
</ul>
<h2 id="开始"><a href="#开始" class="headerlink" title="开始"></a>开始</h2><ul>
<li>创建 Podfile </li>
</ul>
<p>CocoaPods 提供了 <em>pod init</em> 这条快速创建 Podfile 的命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">platform :ios, &apos;8.0&apos;</span><br><span class="line">use_frameworks!</span><br><span class="line"></span><br><span class="line">target &apos;MyApp&apos; do</span><br><span class="line">  pod &apos;AFNetworking&apos;, &apos;~&gt; 2.6&apos;</span><br><span class="line">  pod &apos;ORStackView&apos;, &apos;~&gt; 3.0&apos;</span><br><span class="line">  pod &apos;SwiftyJSON&apos;, &apos;~&gt; 2.3&apos;</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<ul>
<li>安装</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ pod install</span><br><span class="line">$ open App.xcworkspace</span><br></pre></td></tr></table></figure>
<ul>
<li>使用</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#import &lt;Reachability/Reachability.h&gt;</span><br></pre></td></tr></table></figure>
<h2 id="后续"><a href="#后续" class="headerlink" title="后续"></a>后续</h2><p>CocoaPods 是一款包管理工具，可以通过它管理私有库，或者分发私有库。<br>当然，CocoaPds</p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ol>
<li><a href="https://en.wikipedia.org/wiki/CocoaPods" target="_blank" rel="noopener">CocoaPods wikipedia</a></li>
<li><a href="https://cocoapods.org" target="_blank" rel="noopener">CocoaPods 官网</a></li>
</ol>

          
        
      
    </div>
    
    
    

    <div>
      
    </div>
    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2013/07/13/Pre/Blog 发布/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Alice">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hi, this is Alice Home">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2013/07/13/Pre/Blog 发布/" itemprop="url">Blog 发布</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2013-07-13T20:46:25+08:00">
                2013-07-13
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="创建博客"><a href="#创建博客" class="headerlink" title="创建博客"></a>创建博客</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p>
<h3 id="本地运行"><a href="#本地运行" class="headerlink" title="本地运行"></a>本地运行</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p>
<h3 id="本地生成"><a href="#本地生成" class="headerlink" title="本地生成"></a>本地生成</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p>
<h3 id="部署到远程"><a href="#部署到远程" class="headerlink" title="部署到远程"></a>部署到远程</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p>

          
        
      
    </div>
    
    
    

    <div>
      
    </div>
    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/6/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><span class="page-number current">7</span>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="Alice" />
          <p class="site-author-name" itemprop="name">Alice</p>
           
              <p class="site-description motion-element" itemprop="description">The Loneliest Whale in the World</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">70</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">20</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">24</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Alice</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>

  
  <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.2"></script>



  
    <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  




	





  





  






  





  

  

  

  

  

  


</body>
</html>
